<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Sistema de Rifas</title>
    <link rel="stylesheet" href="/assets/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <i class="fas fa-ticket-alt"></i> Sistema de Rifas
            </div>
            <div class="user-info">
                <div class="puntos-badge">
                    <i class="fas fa-coins"></i> 
                    <span id="userPuntos">0</span> puntos
                </div>
                <div style="margin: 0 15px;">
                    Hola, <span id="userNombre" style="font-weight:bold;"></span>
                </div>
                <a href="/admin.html" class="btn btn-secondary" title="Panel de administración">
                    <i class="fas fa-cog"></i> Admin
                </a>
                <button onclick="logout()" class="btn btn-danger">
                    <i class="fas fa-sign-out-alt"></i> Salir
                </button>
            </div>
        </header>
        
        <div class="dashboard-container">
            <!-- Alertas -->
            <div id="alertMessage" class="alert" style="display:none;"></div>
            
            <!-- Estadísticas -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="userPuntosBig">0</div>
                    <div class="stat-label">Puntos Disponibles</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="misNumerosCount">0</div>
                    <div class="stat-label">Mis Números</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">10</div>
                    <div class="stat-label">Puntos por Número</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="numerosDisponibles">100</div>
                    <div class="stat-label">Números Disponibles</div>
                </div>
            </div>
            
            <!-- Instrucciones de recarga -->
            <div class="instructions">
                <h4><i class="fas fa-whatsapp"></i> ¿Necesitas más puntos?</h4>
                <p>
                    Envía el comprobante de pago por WhatsApp al 
                    <strong>+57 XXX-XXX-XXXX</strong> y el administrador sumará puntos a tu cuenta.
                </p>
                <p style="margin-top:5px; font-size:14px;">
                    <i class="fas fa-info-circle"></i> 
                    <strong>Tarifas:</strong> $1.000 = 10 puntos (1 número) | $10.000 = 100 puntos (10 números)
                </p>
            </div>
            
            <!-- Mis números -->
            <h3 class="section-title">
                <i class="fas fa-star"></i> Mis Números Comprados
            </h3>
            <div id="misNumeros" style="
                padding: 15px;
                background: #f0f8ff;
                border-radius: 8px;
                min-height: 50px;
                margin-bottom: 30px;
            ">
                Cargando tus números...
            </div>
            
            <!-- Grid de números -->
            <h3 class="section-title">
                <i class="fas fa-grid"></i> Selecciona un Número (1-100)
            </h3>
            <p style="margin-bottom:20px; color:#666;">
                Haz click en un número <span style="color:#4CAF50;">verde</span> para comprarlo por 10 puntos.
                Los números <span style="color:#F44336;">rojos</span> ya están vendidos.
                Tus números tienen <span style="color:#2196F3;">⭐ estrella azul</span>.
            </p>
            
            <div id="numerosGrid" class="numeros-grid">
                <!-- Los números se cargarán aquí -->
            </div>
            
            <!-- Leyenda -->
            <div style="display:flex; justify-content:center; gap:20px; margin-top:30px; flex-wrap:wrap;">
                <div style="display:flex; align-items:center; gap:8px;">
                    <div style="width:20px; height:20px; background:#4CAF50; border-radius:4px;"></div>
                    <span>Disponible</span>
                </div>
                <div style="display:flex; align-items:center; gap:8px;">
                    <div style="width:20px; height:20px; background:#F44336; border-radius:4px;"></div>
                    <span>Vendido</span>
                </div>
                <div style="display:flex; align-items:center; gap:8px;">
                    <div style="width:20px; height:20px; background:#2196F3; border-radius:4px; border:2px solid gold;"></div>
                    <span>Mi número</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal de confirmación de compra -->
    <div id="compraModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-shopping-cart"></i> Confirmar Compra</h3>
                <button class="close-modal">&times;</button>
            </div>
            
            <div style="text-align:center; padding:20px;">
                <div style="font-size:48px; color:#4CAF50; margin:20px 0;">
                    #<span id="modalNumeroId">00</span>
                </div>
                
                <div style="background:#f9f9f9; padding:15px; border-radius:8px; margin:20px 0;">
                    <p style="margin:10px 0;">
                        <strong>Puntos requeridos:</strong> 
                        <span id="modalPuntosRequeridos" style="color:#F44336;">10</span>
                    </p>
                    <p style="margin:10px 0;">
                        <strong>Tus puntos:</strong> 
                        <span id="modalPuntosDisponibles" style="color:#4CAF50;">0</span>
                    </p>
                    <p style="margin:10px 0;">
                        <strong>Puntos después:</strong> 
                        <span id="modalPuntosRestantes" style="color:#2196F3;">0</span>
                    </p>
                </div>
                
                <p style="color:#666; font-size:14px;">
                    <i class="fas fa-info-circle"></i>
                    Cada número cuesta 10 puntos. No hay reembolsos.
                </p>
            </div>
            
            <div style="display:flex; gap:10px; margin-top:20px;">
                <button onclick="confirmarCompra()" class="btn btn-primary" style="flex:1;">
                    <i class="fas fa-check"></i> Confirmar Compra
                </button>
                <button class="btn btn-cancel" style="flex:1;">
                    <i class="fas fa-times"></i> Cancelar
                </button>
            </div>
        </div>
    </div>
    
    <script src="/assets/app.js"></script>
    <script>
        // Actualizar puntos en el stat-card grande
        function actualizarPuntosBig() {
            const puntos = parseInt(document.getElementById('userPuntos').textContent);
            document.getElementById('userPuntosBig').textContent = puntos;
        }
        
        // Inicializar dashboard
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof cargarDashboard === 'function') {
                cargarDashboard();
            }
            
            // Actualizar puntos grandes cuando cambien
            setInterval(actualizarPuntosBig, 1000);
        });
    </script>
</body>
</html>